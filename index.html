<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Payroll SaaS Intelligence</title>
  <link rel="stylesheet" href="assets/styles.css">
  
  <style>
    /* Updates Feed Container */
    .updates-section {
        margin-top: 2rem;
        margin-bottom: 2rem;
    }

    /* Individual Update Card */
    .update-card {
        background: #ffffff;
        border: 1px solid #eee;
        border-left: 5px solid #007bff; /* Default Blue */
        padding: 1rem;
        margin-bottom: 0.75rem;
        border-radius: 6px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        display: flex;
        flex-direction: column; /* Stack on mobile, row on desktop */
        gap: 0.5rem;
    }

    @media (min-width: 768px) {
        .update-card {
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
        }
    }

    /* Color Coding based on Type */
    .update-card.price-change { border-left-color: #dc3545; } /* Red */
    .update-card.new-vendor { border-left-color: #28a745; }   /* Green */
    .update-card.plan-update { border-left-color: #ffc107; }  /* Yellow */

    .update-meta {
        font-size: 0.85rem;
        color: #6b7280;
        min-width: 100px;
    }

    .update-content {
        flex-grow: 1;
    }

    .update-content h4 {
        margin: 0;
        font-size: 1.1rem;
        color: #111827;
    }

    .update-content p {
        margin: 0.25rem 0 0 0;
        color: #4b5563;
        font-size: 0.95rem;
    }

    .badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 600;
        color: white;
        background-color: #007bff;
        text-transform: uppercase;
        width: fit-content;
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1 class="text-3xl font-bold text-gray-900"><span class="text-indigo-600">Payroll</span>Intel</h1>
      <nav>
        <a href="index.html">Home</a>
        <a href="benchmark.html">Benchmark</a>
        <a href="jobboard.html">Job Board</a>
        <a href="newsletter_template.md">Newsletter</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <h2>Auto-updated pricing & feature benchmark for Payroll SaaS (India)</h2>
      <p>Weekly micro-intelligence packs Â· Live benchmark pages Â· Job board with featured posts</p>
      <p><a class="btn" href="benchmark.html">View Benchmark</a> <a class="btn ghost" href="jobboard.html">View Job Board</a></p>
    </section>

    <section class="updates-section">
      <h3>ðŸ”” Recent Market Updates</h3>
      <div id="changelog-container">
          <p style="color: #666; font-style: italic;">Loading intelligence feed...</p>
      </div>
    </section>

    <hr style="border: 0; border-top: 1px solid #eee; margin: 2rem 0;">

    <section>
      <h3>How it works</h3>
      <ol>
        <li>We collect vendor pages and news using Google Apps Script and summarize with OpenAI.</li>
        <li>Jobs are collected in Airtable and pulled nightly via GitHub Actions.</li>
        <li>Benchmark pages and job board are static and hosted on GitHub Pages.</li>
      </ol>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>Built with automation. Customize for your niche. <a href="README.md">Read docs</a>.</p>
    </div>
  </footer>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    fetch('data/vendors.json')
      .then(response => {
        if (!response.ok) throw new Error("HTTP error " + response.status);
        return response.json();
      })
      .then(data => {
        const tableBody = document.getElementById('benchmark-table-body');
        tableBody.innerHTML = ''; // Clear loading message

        if (data.length === 0) {
            tableBody.innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500">No data found in JSON.</td></tr>';
            return;
        }

        data.forEach(item => {
            const row = document.createElement('tr');
            
            // --- NEW DATA MAPPING MATCHING YOUR SHEET ---
            // We use bracket notation item["..."] because your headers have spaces
            const name = item["Name"] || 'Unknown';
            const plan = item["Plan Name"] || 'Standard';
            const price = item["Price (â‚¹/mo)"] || '-';
            const limits = item["Limits (Users etc.)"] || 'Unspecified';
            const features = item["Key Features"] || '';
            const website = item["Source URL"] || '#';
            const updated = item["Last Updated"] || 'Today';
            // --------------------------------------------

            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                        <div class="ml-4">
                            <div class="text-sm font-medium text-gray-900">
                                <a href="${website}" target="_blank" class="text-blue-600 hover:text-blue-900 hover:underline">
                                    ${name}
                                </a>
                            </div>
                        </div>
                    </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                        ${plan}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    â‚¹${price}
                </td>
                <td class="px-6 py-4 text-sm text-gray-500">
                    ${limits}
                </td>
                <td class="px-6 py-4 text-sm text-gray-500">
                    ${features}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    ${updated}
                </td>
            `;
            tableBody.appendChild(row);
        });
      })
      .catch(error => {
        console.error('Error loading data:', error);
        document.getElementById('benchmark-table-body').innerHTML = `
            <tr><td colspan="6" class="px-6 py-4 text-center text-red-500">
                Error loading data. Check console for details.
            </td></tr>`;
      });
  });
</script>
