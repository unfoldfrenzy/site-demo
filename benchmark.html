<script>
  document.addEventListener('DOMContentLoaded', () => {
    // 1. Fetch the data
    fetch('data/vendors.json')
      .then(response => {
        if (!response.ok) throw new Error("HTTP error " + response.status);
        return response.json();
      })
      .then(data => {
        const tableBody = document.getElementById('benchmark-table-body');
        tableBody.innerHTML = ''; // Clear loading message

        // 2. Handle empty data
        if (!data || data.length === 0) {
            tableBody.innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500">No data found in vendors.json</td></tr>';
            return;
        }

        // 3. Loop through data and create rows
        data.forEach(item => {
            const row = document.createElement('tr');
            
            // --- UPDATED DATA MAPPING (Matches your specific JSON keys) ---
            // We use bracket notation item["Key Name"] because keys have spaces/symbols
            const name = item["Name"] || item["Vendor"] || "Unknown";
            const plan = item["Plan Name"] || item["Plan"] || "N/A";
            const price = item["Price (\u20b9/mo)"] || item["Price"] || "N/A";
            const limits = item["Limits (Users etc.)"] || item["Limits"] || "-";
            const features = item["Key Features"] || item["Features"] || "";
            const url = item["Source URL"] || item["URL"] || "#";
            const lastUpdated = item["Last Updated"] || "Today";
            // -------------------------------------------------------------

            // 4. Build the HTML Row
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                        <div class="ml-4">
                            <div class="text-sm font-medium text-gray-900">
                                ${url !== '#' ? `<a href="${url}" target="_blank" class="text-blue-600 hover:underline">${name}</a>` : name}
                            </div>
                        </div>
                    </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                        ${plan}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    ${price}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    ${limits}
                </td>
                <td class="px-6 py-4 text-sm text-gray-500 max-w-xs truncate" title="${features}">
                    ${features}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    ${lastUpdated}
                </td>
            `;
            tableBody.appendChild(row);
        });
      })
      .catch(error => {
        console.error('Error loading data:', error);
        document.getElementById('benchmark-table-body').innerHTML = `
            <tr><td colspan="6" class="px-6 py-4 text-center text-red-500">
                Error loading data. <br> <span class="text-xs text-gray-400">${error.message}</span>
            </td></tr>`;
      });
  });
</script>
