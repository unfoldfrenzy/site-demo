<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Job Board - Payroll SaaS</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">

<header class="bg-white shadow">
  <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 flex justify-between">
    <h1 class="text-3xl font-bold text-gray-900">Job Board</h1>
    <nav class="space-x-4">
      <a href="index.html" class="text-gray-500 hover:text-gray-900">Home</a>
      <a href="benchmark.html" class="text-gray-500 hover:text-gray-900">Benchmark</a>
    </nav>
  </div>
</header>

<main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
  <div class="px-4 py-6 sm:px-0">
    <h2 class="text-xl font-semibold mb-6">Open Roles (Payroll SaaS)</h2>
    
    <div id="job-container" class="space-y-4">
      <div class="text-gray-500">Loading jobs...</div>
    </div>

  </div>
</main>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // 1. Fetch the data file
    fetch('data/jobs.json')
      .then(response => {
        if (!response.ok) throw new Error("HTTP error " + response.status);
        return response.json();
      })
      .then(data => {
        const container = document.getElementById('job-container');
        container.innerHTML = ''; // Clear loading message

        if (data.length === 0) {
            container.innerHTML = '<p class="text-gray-500">No jobs found.</p>';
            return;
        }

        // 2. Loop through each job
        data.forEach(job => {
            // SAFE DATA MAPPING:
            // Checks for 'title' (Clean JSON) OR 'Job Title' (Raw Airtable)
            // This ensures it works no matter which script format you used.
            const title = job.title || job['Job Title'] || job.fields?.['Job Title'] || 'Untitled Role';
            const company = job.company || job['Company'] || job.fields?.['Company'] || 'Unknown Company';
            const location = job.location || job['Location'] || job.fields?.['Location'] || 'Remote';
            const type = job.type || job['Job Type'] || job.fields?.['Job Type'] || 'Full-time';
            const url = job.url || job['Apply Link'] || job.fields?.['Apply Link'] || '#';
            
            // 3. Create the Job Card
            const card = document.createElement('div');
            card.className = "bg-white shadow overflow-hidden sm:rounded-lg p-6 hover:shadow-md transition";
            
            card.innerHTML = `
                <div class="flex justify-between items-start">
                    <div>
                        <h3 class="text-lg leading-6 font-medium text-gray-900">
                            ${title}
                        </h3>
                        <p class="mt-1 max-w-2xl text-sm text-gray-500">
                            ${company}
                        </p>
                    </div>
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                        ${type}
                    </span>
                </div>
                <div class="mt-4 flex items-center text-sm text-gray-500">
                    <svg class="flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    ${location}
                </div>
                <div class="mt-5">
                    <a href="${url}" target="_blank" class="text-indigo-600 hover:text-indigo-900 font-medium">
                        Apply for this role &rarr;
                    </a>
                </div>
            `;
            container.appendChild(card);
        });
      })
      .catch(error => {
        console.error('Error:', error);
        document.getElementById('job-container').innerHTML = 
            '<p class="text-red-500">Error loading jobs. Check console.</p>';
      });
  });
</script>

</body>
</html>
